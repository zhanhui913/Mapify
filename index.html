<!DOCTYPE html>
<html>
	<head>
		<title>jQuery mapify - Custom View</title>
		<style type="text/css" media="all">@import "css/marker.css";</style>
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" media="screen">

		<script type="text/javascript" src="js/jquery/jquery.js"></script>
		<script type="text/javascript" src="js/jquery/jquery-ui.js"></script>
		<!--<script type="text/javascript" src="../libs/jquery.fs.zoetrope.min.js"></script> used for polyfill and polyline-->
		<script type="text/javascript" src="js/toe.min.js"></script>
		<script type="text/javascript" src="js/jquery.mousewheel.min.js"></script>
		<script type="text/javascript" src="js/imgViewer.js"></script> <!-- Should be minimized version when deployed-->
		<script type="text/javascript" src="js/mapify.js"></script>
	</head>
	<body>
		<h1 style="text-align: center;">Zhan's mapify.</h1>
		<p>
			This example demonstrates the use of jquery's plugin imgViewer in combination of mapify. You must provide the top left and bottom right corner of the image's latitude and longitude in order to calculate any latitude/longitude inside.
		</p>
		<div class="mapify" style="text-align: center">
			<div><p>TopLeft Latitude :</p><input type="number" id="topLeftLat" disabled> <p>TopLeft Longitude :</p><input type="number" id="topLeftLng"  disabled></div>
			<div><p>Marker Latitude :</p><input type="number" id="markerLat"> <p>Marker Longitude :</p><input type="number" id="markerLng"></div>
			<div><p>BottomRight Latitude :</p><input type="number" id="bottomRightLat" disabled> <p>BottomRight Longitude :</p><input type="number" id="bottomRightLng"  disabled></div>
			<button id="editMode">Edit</button>
			<br></br>
			<img class="image" src="img/vancouverMap.jpg" />
		</div>
		<script type="text/javascript">
		(function($) {
			$(document).ready(function() {
				var $img = $(".image").mapify({
							topLatLng:{lat:49.285546, lng:-123.119395},
							botLatLng:{lat:49.284271, lng:-123.117394},
							markersLatLng:[
								{lat: 49.284893, lng: -123.118376, note: "Intersection"},
								{lat: 49.285524, lng: -123.118718, note: "Cactus Club"},
								{lat: 49.285022, lng: -123.118267, note: "Brandi Show Lounge"}
							],
							marker:{
								src:"img/marker.png",
								width:27,
								height:40,
								textColor:'#F0F',
								textSize:15
							},
							zoomable:true,
							onShow: $.noop, //jQuery's default empty function - $.noop
							onAdd: function() {
								this.options.vAll = "bottom";
								this.options.hAll = "middle";
								var elem = $(document.createElement('span')).addClass("marker notSelected").html(this.markerCount).attr("title", "");
								var self = this;
								$(elem).tooltip({
									content: function() {
										return $(elem).data("note");
									}
								});
								return elem;
							},
							onDragStart:function(){console.log("override on drag start");},
							onDrag:function(){console.log("override on drag");},
							onDragStop:function(){console.log("override on drag stop");},
				});
				var $toggle = $("#editMode");
				if($img.mapify("option","editMode")){
					$toggle.text("View");
				}else{
					$toggle.text("Edit");
				}
				$toggle.on("click",function(){
					var $this = $(this);
					if($this.text() == "Edit"){
						$this.text("View");
						$img.mapify("option","editMode",true);
					}else{
						$this.text("Edit");
						$img.mapify("option","editMode",false);
						$img.mapify("resetSelected");
					}
				});
				//Can also use this way to add markers
				/*$img.mapify("importLatLng", [
					//{lat: 49.284893, lng:-123.118376, note:"Intersection"},
					//{lat: 49.285524, lng:-123.118718, note:"Cactus Club"},
					//{lat:49.285022 , lng: -123.118267, note:"Brandi Show Lounge"}
				]);
				*/
		  	});
		})(jQuery);
		</script>
	</body>
</html>